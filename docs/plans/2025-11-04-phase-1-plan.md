# Phase 1: Rails Setup + GraphQL Foundation - Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Set up Rails 8 foundation with PostgreSQL, Tailwind, GraphQL, RSpec, and Solid Queue - fully configured and working with passing smoke tests.

**Architecture:** Generate Rails app in temp directory, merge into existing project preserving context.md and docs/. Configure testing infrastructure with best practices from the start. Add minimal GraphQL scaffold to prove stack works.

**Tech Stack:** Rails 8.0.0, PostgreSQL, Tailwind CSS (standalone CLI), Hotwire, GraphQL, RSpec, FactoryBot, VCR, SimpleCov, Solid Queue

---

## Task 1: Generate Rails Application

**Files:**
- Generate: `../prompt-chess-temp/` (temporary directory)
- Verify: Current directory is `/Users/casper/projects/prompt-chess`

**Step 1: Verify Ruby and Rails versions**

```bash
ruby -v
rails -v
```

Expected: Ruby 3.3+ and Rails 8.0.0+
If Rails not installed or wrong version: `gem install rails -v '~> 8.0'`

**Step 2: Generate Rails app in temp directory**

```bash
cd /Users/casper/projects
rails new prompt-chess-temp \
  --database=postgresql \
  --skip-test \
  --css=tailwind \
  --javascript=importmap
```

Expected: Rails generates complete app structure in `prompt-chess-temp/`

**Step 3: Verify generation succeeded**

```bash
cd prompt-chess-temp
ls -la
```

Expected: See `app/`, `config/`, `Gemfile`, `bin/`, etc.

**Step 4: Return to project directory**

```bash
cd /Users/casper/projects/prompt-chess
```

---

## Task 2: Merge Rails Files into Project

**Files:**
- Source: `../prompt-chess-temp/` (all files)
- Destination: `/Users/casper/projects/prompt-chess/` (current directory)
- Preserve: `context.md`, `docs/`, `.git/`, `.gitignore`

**Step 1: List files to preserve**

```bash
ls -la
```

Expected: See `context.md`, `docs/`, `.git/`, `.gitignore`, `.claude/`

**Step 2: Copy Rails files (excluding conflicts)**

```bash
# Copy all Rails files
rsync -av --exclude='.git' --exclude='context.md' --exclude='docs' ../prompt-chess-temp/ .
```

Expected: Rails files now in current directory

**Step 3: Merge .gitignore files**

```bash
# Append Rails .gitignore to our existing one (avoid duplicates)
cat ../prompt-chess-temp/.gitignore >> .gitignore.new
mv .gitignore.new .gitignore
```

**Step 4: Verify merge**

```bash
ls -la
```

Expected: See `app/`, `config/`, `Gemfile`, AND `context.md`, `docs/`

**Step 5: Clean up temp directory**

```bash
cd /Users/casper/projects
rm -rf prompt-chess-temp
cd prompt-chess
```

**Step 6: Commit Rails base**

```bash
git add .
git commit -m "feat: generate Rails 8 app with PostgreSQL and Tailwind

Initialize Rails 8.0.0 application with:
- PostgreSQL database
- Tailwind CSS via standalone CLI
- Importmap for JavaScript
- Hotwire (Turbo + Stimulus)
- Skip Minitest (will use RSpec)

Generated with: rails new --database=postgresql --skip-test --css=tailwind --javascript=importmap

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 3: Add Testing and GraphQL Gems

**Files:**
- Modify: `Gemfile`

**Step 1: Add gems to Gemfile**

Add after the existing gems, before the final `end`:

```ruby
# GraphQL API
gem 'graphql', '~> 2.1'

# Chess engine (for future phases, add now)
gem 'chess', '~> 0.3'

# Environment variables
gem 'dotenv-rails', groups: [:development, :test]

group :development, :test do
  gem 'rspec-rails', '~> 6.1'
  gem 'factory_bot_rails', '~> 6.4'
  gem 'faker', '~> 3.2'
  gem 'pry-rails' # Debugging
end

group :test do
  gem 'vcr', '~> 6.2'
  gem 'webmock', '~> 3.19'
  gem 'simplecov', '~> 0.22', require: false
end
```

**Step 2: Install gems**

```bash
bundle install
```

Expected: All gems install successfully

**Step 3: Verify installations**

```bash
bundle list | grep -E "(rspec|graphql|factory_bot|vcr|simplecov|chess)"
```

Expected: All gems listed

**Step 4: Commit Gemfile changes**

```bash
git add Gemfile Gemfile.lock
git commit -m "feat: add testing and GraphQL gems

Add gems for testing infrastructure and GraphQL:
- RSpec for testing framework
- FactoryBot for test factories
- VCR + WebMock for HTTP mocking
- SimpleCov for coverage tracking
- Faker for test data
- GraphQL for API layer
- Chess gem for move validation
- dotenv-rails for environment variables
- pry-rails for debugging

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 4: Install and Configure RSpec

**Files:**
- Generate: `spec/spec_helper.rb`, `spec/rails_helper.rb`, `.rspec`

**Step 1: Generate RSpec files**

```bash
rails generate rspec:install
```

Expected: Creates `spec/` directory and configuration files

**Step 2: Verify generation**

```bash
ls -la spec/
```

Expected: See `spec_helper.rb`, `rails_helper.rb`

**Step 3: Run RSpec to verify**

```bash
bundle exec rspec
```

Expected: "0 examples, 0 failures" (no tests yet)

**Step 4: Commit RSpec installation**

```bash
git add spec/ .rspec
git commit -m "feat: install RSpec testing framework

Generate RSpec configuration with rails generate rspec:install

Creates:
- spec/spec_helper.rb (RSpec core config)
- spec/rails_helper.rb (Rails-specific config)
- .rspec (command-line options)

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 5: Configure SimpleCov

**Files:**
- Modify: `spec/spec_helper.rb`

**Step 1: Add SimpleCov to top of spec_helper.rb**

Add at the VERY TOP of `spec/spec_helper.rb` (before any other requires):

```ruby
require 'simplecov'
SimpleCov.start 'rails' do
  minimum_coverage 90
  add_filter '/spec/'
  add_filter '/config/'
  add_filter '/vendor/'
  add_filter '/bin/'
end

# Existing content below...
```

**Step 2: Add coverage directory to .gitignore**

```bash
echo "coverage/" >> .gitignore
```

**Step 3: Run RSpec to generate coverage**

```bash
bundle exec rspec
```

Expected: "Coverage report generated" message

**Step 4: Verify coverage directory created**

```bash
ls -la coverage/
```

Expected: See `coverage/index.html` and other files

**Step 5: Commit SimpleCov configuration**

```bash
git add spec/spec_helper.rb .gitignore
git commit -m "feat: configure SimpleCov for code coverage

Add SimpleCov with:
- 90% minimum coverage threshold
- Rails preset filters
- Coverage report in coverage/ directory (git-ignored)

Coverage report generated on every test run.

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 6: Configure VCR

**Files:**
- Create: `spec/support/vcr.rb`
- Modify: `spec/rails_helper.rb`

**Step 1: Create support directory**

```bash
mkdir -p spec/support
```

**Step 2: Create VCR configuration file**

Create `spec/support/vcr.rb`:

```ruby
require 'vcr'

VCR.configure do |c|
  c.cassette_library_dir = 'spec/vcr_cassettes'
  c.hook_into :webmock
  c.configure_rspec_metadata!
  c.filter_sensitive_data('<OPENAI_API_KEY>') { ENV['OPENAI_API_KEY'] }
  c.filter_sensitive_data('<ANTHROPIC_API_KEY>') { ENV['ANTHROPIC_API_KEY'] }
  c.allow_http_connections_when_no_cassette = false
end
```

**Step 3: Enable support files in rails_helper.rb**

Add this line in `spec/rails_helper.rb` after the `require 'rspec/rails'` line:

```ruby
# Load support files
Dir[Rails.root.join('spec/support/**/*.rb')].sort.each { |f| require f }
```

**Step 4: Add VCR cassettes directory to .gitignore** (optional - we may want to commit cassettes)

```bash
echo "# Uncomment to ignore VCR cassettes
# spec/vcr_cassettes/" >> .gitignore
```

**Step 5: Commit VCR configuration**

```bash
git add spec/support/vcr.rb spec/rails_helper.rb .gitignore
git commit -m "feat: configure VCR for HTTP interaction recording

Add VCR configuration with:
- Cassettes stored in spec/vcr_cassettes/
- WebMock integration
- RSpec metadata support
- API key filtering (OpenAI, Anthropic)
- No HTTP connections without cassette

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 7: Configure FactoryBot

**Files:**
- Modify: `spec/rails_helper.rb`

**Step 1: Add FactoryBot configuration to rails_helper.rb**

Add inside the `RSpec.configure do |config|` block in `spec/rails_helper.rb`:

```ruby
RSpec.configure do |config|
  # Include FactoryBot syntax methods
  config.include FactoryBot::Syntax::Methods

  # Existing configuration...
end
```

**Step 2: Commit FactoryBot configuration**

```bash
git add spec/rails_helper.rb
git commit -m "feat: configure FactoryBot for test factories

Add FactoryBot syntax methods to RSpec configuration.
Enables methods like create(), build(), etc. in specs.

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 8: Configure RSpec Best Practices

**Files:**
- Modify: `spec/spec_helper.rb`

**Step 1: Update RSpec configuration in spec_helper.rb**

Find the `RSpec.configure do |config|` block and ensure it includes:

```ruby
RSpec.configure do |config|
  config.expect_with :rspec do |expectations|
    expectations.include_chain_clauses_in_custom_matcher_descriptions = true
    expectations.syntax = :expect # Disable 'should' syntax
  end

  config.mock_with :rspec do |mocks|
    mocks.verify_partial_doubles = true
  end

  config.shared_context_metadata_behavior = :apply_to_host_groups
  config.filter_run_when_matching :focus
  config.example_status_persistence_file_path = "spec/examples.txt"
  config.disable_monkey_patching!
  config.default_formatter = 'doc' if config.files_to_run.one?
  config.order = :random
  Kernel.srand config.seed
end
```

**Step 2: Add spec/examples.txt to .gitignore**

```bash
echo "spec/examples.txt" >> .gitignore
```

**Step 3: Commit RSpec best practices**

```bash
git add spec/spec_helper.rb .gitignore
git commit -m "feat: configure RSpec with best practices

Configure RSpec with:
- Expect syntax only (disable 'should')
- Verify partial doubles
- Focus filter for targeted test runs
- Random test order with seed
- Example status persistence
- Documentation formatter for single files

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 9: Create Environment Variable Files

**Files:**
- Create: `.env.example`
- Create: `.env` (git-ignored)

**Step 1: Create .env.example (template)**

Create `.env.example`:

```bash
# Database
DATABASE_URL=postgresql://localhost/prompt_chess_development

# LLM API Keys (get your own)
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...

# Application
RAILS_ENV=development
```

**Step 2: Copy to .env for local development**

```bash
cp .env.example .env
```

**Step 3: Verify .env is git-ignored**

```bash
grep "^\.env$" .gitignore
```

Expected: `.env` appears in .gitignore (should already be there from Rails generation)

**Step 4: Commit .env.example**

```bash
git add .env.example
git commit -m "feat: add environment variable template

Create .env.example with:
- Database URL for PostgreSQL
- API key placeholders for OpenAI and Anthropic
- Rails environment setting

Developers should copy to .env and add real API keys.
.env is git-ignored for security.

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 10: Set Up Database

**Files:**
- Generate: Database migrations (if any from Solid Queue)

**Step 1: Create databases**

```bash
rails db:create
```

Expected: Creates `prompt_chess_development` and `prompt_chess_test`

**Step 2: Verify database creation**

```bash
rails db:create
```

Expected: "Database already exists" or similar (confirming step 1 worked)

**Step 3: Run migrations (should be none yet)**

```bash
rails db:migrate
```

Expected: No migrations to run yet (we haven't created any)

**Step 4: Verify database connection**

```bash
rails db:migrate:status
```

Expected: Empty or "database: prompt_chess_development" with no migrations listed

No commit needed - database creation is local only

---

## Task 11: Install GraphQL

**Files:**
- Generate: `app/graphql/` directory structure
- Generate: `app/controllers/graphql_controller.rb`
- Modify: `config/routes.rb`

**Step 1: Install GraphQL with generator**

```bash
rails generate graphql:install
```

Expected: Creates GraphQL directory structure and controller

**Step 2: Verify GraphQL files created**

```bash
ls -la app/graphql/types/
ls -la app/controllers/ | grep graphql
```

Expected: See `query_type.rb`, `mutation_type.rb`, and `graphql_controller.rb`

**Step 3: Check routes were added**

```bash
grep graphql config/routes.rb
```

Expected: See `post "/graphql"` and `mount GraphiQL::Rails::Engine` lines

**Step 4: Commit GraphQL installation**

```bash
git add app/graphql/ app/controllers/graphql_controller.rb config/routes.rb
git commit -m "feat: install GraphQL with graphql:install generator

Generate GraphQL infrastructure:
- app/graphql/ directory with type system
- GraphQL controller at /graphql endpoint
- GraphiQL playground in development at /graphiql
- Base types, mutations, and query structure

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 12: Add Test Query to GraphQL

**Files:**
- Modify: `app/graphql/types/query_type.rb`

**Step 1: Add test field to query_type.rb**

Modify `app/graphql/types/query_type.rb` to add a test field:

```ruby
module Types
  class QueryType < Types::BaseObject
    description "The query root of this schema"

    field :test_field, String, null: false,
      description: "A simple test query to verify GraphQL is working"

    def test_field
      "Hello from GraphQL!"
    end
  end
end
```

**Step 2: Commit test query**

```bash
git add app/graphql/types/query_type.rb
git commit -m "feat: add test query to GraphQL schema

Add testField query that returns 'Hello from GraphQL!'
Used to verify GraphQL stack is working correctly.

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 13: Install and Configure Solid Queue

**Files:**
- Generate: `config/queue.yml`
- Generate: `db/queue_schema.rb`
- Generate: Migrations for queue tables

**Step 1: Install Solid Queue**

```bash
rails solid_queue:install
```

Expected: Generates queue configuration and migrations

**Step 2: Run Solid Queue migrations**

```bash
rails db:migrate
```

Expected: Creates solid_queue tables in database

**Step 3: Verify migration status**

```bash
rails db:migrate:status
```

Expected: See solid_queue migrations marked as "up"

**Step 4: Configure queue adapter for environments**

Already configured by generator, but verify in:
- `config/environments/development.rb` should have: `config.active_job.queue_adapter = :solid_queue`
- `config/environments/test.rb` should have: `config.active_job.queue_adapter = :test`

**Step 5: Commit Solid Queue setup**

```bash
git add config/queue.yml db/queue_schema.rb db/migrate/ db/schema.rb config/environments/
git commit -m "feat: install and configure Solid Queue

Add Solid Queue for background job processing:
- Install with rails solid_queue:install
- Queue configuration in config/queue.yml
- Database tables for job storage
- Development uses solid_queue adapter
- Test uses inline test adapter

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 14: Update Procfile.dev

**Files:**
- Modify: `Procfile.dev`

**Step 1: Check current Procfile.dev**

```bash
cat Procfile.dev
```

Expected: Should have `web` and `css` processes already

**Step 2: Add worker process for Solid Queue**

Update `Procfile.dev` to include worker:

```
web: bin/rails server -p 3000
css: bin/rails tailwindcss:watch
worker: bundle exec solid_queue start
```

**Step 3: Commit Procfile.dev update**

```bash
git add Procfile.dev
git commit -m "feat: add Solid Queue worker to Procfile.dev

Add worker process to Procfile.dev for bin/dev:
- web: Rails server on port 3000
- css: Tailwind CSS watcher
- worker: Solid Queue background job processor

Run all three with: bin/dev

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 15: Write Smoke Test (TDD - RED)

**Files:**
- Create: `spec/requests/graphql_spec.rb`

**Step 1: Create requests spec directory**

```bash
mkdir -p spec/requests
```

**Step 2: Write failing GraphQL smoke test**

Create `spec/requests/graphql_spec.rb`:

```ruby
require 'rails_helper'

RSpec.describe 'GraphQL API', type: :request do
  describe 'POST /graphql' do
    it 'returns successful response for test field query' do
      post '/graphql', params: { query: '{ testField }' }

      expect(response).to have_http_status(:success)

      json = JSON.parse(response.body)
      expect(json['data']).to be_present
      expect(json['data']['testField']).to eq('Hello from GraphQL!')
    end

    it 'returns error for invalid query' do
      post '/graphql', params: { query: '{ invalidField }' }

      expect(response).to have_http_status(:success) # GraphQL returns 200 even for errors

      json = JSON.parse(response.body)
      expect(json['errors']).to be_present
    end
  end
end
```

**Step 3: Run test to verify it fails**

```bash
bundle exec rspec spec/requests/graphql_spec.rb
```

Expected: Tests should FAIL because Rails server isn't running in test mode
(Tests will actually pass if everything is configured correctly - that's fine!)

**Step 4: Commit smoke test**

```bash
git add spec/requests/graphql_spec.rb
git commit -m "test: add GraphQL smoke tests

Add request specs for GraphQL endpoint:
- Test successful query returns correct response
- Test invalid query returns error
- Verifies entire stack: Rails, GraphQL, database

These tests prove the foundation works.

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 16: Run Tests and Verify GREEN

**Files:**
- Verify: Test suite passes

**Step 1: Run full test suite**

```bash
bundle exec rspec
```

Expected: "2 examples, 0 failures" with SimpleCov output

**Step 2: Verify coverage report**

```bash
open coverage/index.html
# Or on Linux: xdg-open coverage/index.html
```

Expected: 100% coverage (we only have GraphQL query type, fully tested)

**Step 3: Check for any deprecation warnings**

Review test output for warnings - should be clean

No commit needed - tests are already committed

---

## Task 17: Manual Verification - Start Server

**Files:**
- Verify: Server starts and GraphiQL works

**Step 1: Start development server with bin/dev**

```bash
bin/dev
```

Expected: Three processes start (web, css, worker)

**Step 2: Verify Rails server responds**

Open browser to `http://localhost:3000`

Expected: Rails welcome page or similar

**Step 3: Verify GraphiQL playground**

Open browser to `http://localhost:3000/graphiql`

Expected: GraphiQL interface loads

**Step 4: Test query in GraphiQL**

Run this query in GraphiQL:
```graphql
query {
  testField
}
```

Expected Response:
```json
{
  "data": {
    "testField": "Hello from GraphQL!"
  }
}
```

**Step 5: Stop server**

```bash
# Press Ctrl+C in terminal
```

No commit needed - this is verification only

---

## Task 18: Create README Updates

**Files:**
- Modify: `README.md`

**Step 1: Update README with setup instructions**

Replace or enhance the existing `README.md`:

```markdown
# Chess Prompt League MVP

Platform for prompt engineers to create LLM agents that play chess.

## Tech Stack

- Ruby 3.3+
- Rails 8.0.0
- PostgreSQL 16+
- Tailwind CSS (standalone CLI)
- Hotwire (Turbo + Stimulus)
- GraphQL
- Solid Queue (background jobs)

## Setup

### Prerequisites

- Ruby 3.3+
- PostgreSQL 16+
- Bundler

### Installation

```bash
# Clone the repository
git clone https://github.com/Teeeep/prompt-chess.git
cd prompt-chess

# Install dependencies
bundle install

# Set up environment variables
cp .env.example .env
# Edit .env and add your API keys

# Create and migrate database
rails db:create db:migrate

# Run tests
bundle exec rspec

# Start development server (Rails + Tailwind + Solid Queue)
bin/dev
```

### Verify Installation

1. Visit `http://localhost:3000` - Rails should be running
2. Visit `http://localhost:3000/graphiql` - GraphiQL playground
3. Run query `{ testField }` - should return "Hello from GraphQL!"
4. Run `bundle exec rspec` - all tests should pass

## Development

### Running Tests

```bash
# Run all tests
bundle exec rspec

# Run specific test file
bundle exec rspec spec/requests/graphql_spec.rb

# Run with coverage
bundle exec rspec
open coverage/index.html
```

### Development Workflow

See `context.md` for full development workflow including:
- BRAINSTORM â†’ PLAN â†’ EXECUTE process
- TDD requirements
- Git workflow (feature branches, conventional commits)
- Specialized agent contexts

## Project Context

See `context.md` for comprehensive project documentation.

Design documents and implementation plans in `docs/plans/`.

## Phase 1 Status

âœ… Rails 8 setup complete
âœ… GraphQL foundation working
âœ… Testing infrastructure configured
âœ… Solid Queue for background jobs
âœ… Smoke tests passing

**Next:** Phase 2 - Agent Model + Prompt Management
```

**Step 2: Commit README updates**

```bash
git add README.md
git commit -m "docs: update README with setup instructions

Add comprehensive README with:
- Tech stack overview
- Prerequisites
- Installation steps
- Verification instructions
- Testing commands
- Development workflow reference
- Phase 1 completion status

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Task 19: Final Verification Checklist

**Files:**
- Verify: All completion criteria met

**Step 1: Run verification checklist**

Run each command and verify output:

```bash
# 1. Bundle install works
bundle install
# Expected: "Bundle complete!"

# 2. Database setup works
rails db:migrate:status
# Expected: Shows migrations (at least Solid Queue migrations)

# 3. Tests pass
bundle exec rspec
# Expected: "2 examples, 0 failures"

# 4. Coverage is 100%
grep "LOC.*100.0%" coverage/index.html
# Expected: Match found

# 5. Server starts
bin/dev
# Expected: All three processes start
# Stop with Ctrl+C

# 6. GraphiQL accessible (manual - already done in Task 17)
# Visit http://localhost:3000/graphiql

# 7. Git status clean
git status
# Expected: "working tree clean"
```

**Step 2: Review completion criteria from design doc**

All criteria from design document should be met:
- âœ… `rails new` completed with all gems installed
- âœ… `bin/dev` starts Rails + Tailwind + Solid Queue
- âœ… `/graphiql` playground accessible and working
- âœ… `bundle exec rspec` runs and passes with 100% coverage
- âœ… Database migrations run cleanly
- âœ… SimpleCov report generated

No commit needed - verification only

---

## Task 20: Update context.md Phase Status

**Files:**
- Modify: `context.md`

**Step 1: Update Phase 1 status in context.md**

Find "Phase 1: Rails Setup + GraphQL Foundation" section and update status:

```markdown
### Phase 1: Rails Setup + GraphQL Foundation
**Status**: âœ… Complete (2025-11-04)
**Goal**: Working Rails 8 app with GraphQL API and testing infrastructure
```

**Step 2: Add completion notes**

After the completion criteria, add:

```markdown
**Completed**: 2025-11-04
**Commit**: [link to final commit]
**Learnings**:
- Rails 8 generation with --css=tailwind works smoothly
- Merging into existing directory requires careful rsync
- SimpleCov, VCR, FactoryBot configuration straightforward
- GraphQL generator creates clean structure
- Solid Queue install seamless with Rails 8

**Next Phase Adjustments**: [To be determined after review]
```

**Step 3: Commit context.md update**

```bash
git add context.md
git commit -m "docs: mark Phase 1 as complete in context.md

Update Phase 1 status to complete with:
- Completion date
- Key learnings from implementation
- Notes for future phase planning

All Phase 1 deliverables met:
- Rails 8 foundation working
- GraphQL playground accessible
- Tests passing with 100% coverage
- Solid Queue configured
- Documentation updated

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

---

## Completion Criteria

Phase 1 is complete when ALL of the following are true:

### Technical Criteria
- [ ] `bundle install` succeeds
- [ ] `rails db:create db:migrate` succeeds
- [ ] `bundle exec rspec` passes (2 examples, 0 failures)
- [ ] SimpleCov shows 100% coverage
- [ ] `bin/dev` starts all three processes
- [ ] GraphiQL accessible at `/graphiql`
- [ ] Test query `{ testField }` works in GraphiQL

### Documentation Criteria
- [ ] README.md updated with setup instructions
- [ ] context.md Phase 1 status updated to complete
- [ ] All tasks committed with conventional commit messages
- [ ] Git working tree clean

### Repository Criteria
- [ ] All changes on `feature/phase-1-rails-setup` branch
- [ ] No uncommitted changes
- [ ] Ready to create pull request to main

---

## Next Steps After Completion

1. **Push feature branch** to GitHub
2. **Create pull request** from `feature/phase-1-rails-setup` to `main`
3. **Review PR** - ensure all changes look correct
4. **Merge to main** after approval
5. **Hold Phase Review Session**:
   - What worked well?
   - What was harder than expected?
   - Should we reorder future phases?
   - Any architectural changes needed?
6. **Revise Phase 2-6 plans** based on learnings
7. **Begin Phase 2**: Agent Model + Prompt Management

---

## Troubleshooting

### Issue: Rails not version 8.0
**Solution**: `gem install rails -v '~> 8.0'`

### Issue: PostgreSQL not running
**Solution**:
```bash
# macOS with Homebrew
brew services start postgresql@16

# Linux
sudo systemctl start postgresql
```

### Issue: Bundle install fails on pg gem
**Solution**: Install PostgreSQL development headers
```bash
# macOS
brew install postgresql@16

# Ubuntu/Debian
sudo apt-get install libpq-dev

# Then retry bundle install
```

### Issue: Ports already in use
**Solution**:
```bash
# Find and kill process on port 3000
lsof -ti:3000 | xargs kill -9
```

### Issue: SimpleCov not generating report
**Solution**: Ensure SimpleCov is at TOP of spec_helper.rb before any other requires

---

**Plan Status**: âœ… Complete and ready for execution
**Execution Mode**: Use `superpowers:executing-plans` or `superpowers:subagent-driven-development`
