<div class="container mx-auto px-4 py-8"
     data-controller="match-subscription"
     data-match-subscription-match-id-value="<%= @match.id %>">

  <!-- Header -->
  <div class="bg-white rounded-lg shadow-md p-6 mb-6">
    <h1 class="text-3xl font-bold mb-2">
      Match #<%= @match.id %>
    </h1>
    <div class="text-gray-600">
      <%= @match.agent.name %> vs Stockfish Level <%= @match.stockfish_level %>
    </div>
    <div class="mt-2">
      <span class="px-3 py-1 rounded-full text-sm font-semibold
        <%= case @match.status
            when 'pending' then 'bg-yellow-100 text-yellow-800'
            when 'in_progress' then 'bg-blue-100 text-blue-800'
            when 'completed' then 'bg-green-100 text-green-800'
            when 'errored' then 'bg-red-100 text-red-800'
            end %>">
        <%= @match.status.titleize %>
      </span>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Chess Board -->
    <div class="lg:col-span-2">
      <%= render MatchBoardComponent.new(match: @match) %>
    </div>

    <!-- Sidebar -->
    <div class="space-y-6">
      <!-- Match Stats -->
      <%= render MatchStatsComponent.new(match: @match) %>

      <!-- Move List -->
      <%= render MoveListComponent.new(match: @match) %>
    </div>
  </div>

  <!-- Thinking Log (full width below) -->
  <% if @latest_agent_move %>
    <div class="mt-6">
      <%= render ThinkingLogComponent.new(move: @latest_agent_move) %>
    </div>
  <% end %>

  <!-- Game Status -->
  <% if @match.status_completed? %>
    <div class="bg-white rounded-lg shadow-md p-6 mt-4">
      <h2 class="text-xl font-bold mb-2">Game Over</h2>
      <p class="text-lg">
        <% if @match.winner_draw? %>
          Draw by stalemate
        <% elsif @match.winner_agent? %>
          <%= @match.agent.name %> wins by checkmate!
        <% else %>
          Stockfish wins by checkmate
        <% end %>
      </p>
    </div>
  <% end %>
</div>
